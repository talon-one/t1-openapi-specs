# path: /v1/loyalty_programs/{loyaltyProgramId}/cards/{loyaltyCardId}/balances
get:
  operationId: getLoyaltyCardBalances
  summary: Get card's point balances
  description: >
    Retrieve loyalty balances for the given loyalty card in the specified
    loyalty program with filtering options applied.

    If no filtering options are applied, all loyalty balances for the given
    loyalty card are returned.
  security:
    - api_key_v1: []
  tags:
    - Loyalty cards
  parameters:
    - name: loyaltyProgramId
      in: path
      description: >
        Identifier of the card-based loyalty program containing the loyalty
        card. You can get the ID with

        the [List loyalty
        programs](https://docs.talon.one/management-api#tag/Loyalty/operation/getLoyaltyPrograms)
        endpoint.
      example: 33
      required: true
      schema:
        type: integer
    - name: loyaltyCardId
      in: path
      description: >
        Identifier of the loyalty card. You can get the identifier with

        the [List loyalty
        cards](https://docs.talon.one/management-api#tag/Loyalty-cards/operation/getLoyaltyCards)
        endpoint.
      example: summer-loyalty-card-0543
      required: true
      schema:
        type: string
        maxLength: 108
    - name: endDate
      in: query
      required: false
      description: >
        Used to return expired, active, and pending loyalty balances before this
        timestamp. You can enter any past, present, or future timestamp value.


        **Note:**


        - It must be an RFC3339 timestamp string.

        - You can include a time component in your string, for example,
        `T23:59:59` to specify the end of the day. The time zone setting
        considered is `UTC`. If you do not include a time component, a default
        time value of `T00:00:00` (midnight) in `UTC` is considered.
      example: '2024-05-29T15:04:05+07:00'
      schema:
        type: string
        format: date-time
    - name: subledgerId
      in: query
      required: false
      description: Filter results by one or more subledger IDs. Must be exact match.
      example:
        - subledger1
        - subledger2
      style: form
      explode: true
      schema:
        type: array
        items:
          type: string
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            allOf:
              - type: object
                description: List of loyalty balances for a ledger and its subledgers.
                properties:
                  balance:
                    title: Loyalty points balance of a ledger
                    type: object
                    description: Point balance of a ledger in the Loyalty Program.
                    properties:
                      activePoints:
                        type: number
                        title: Current Balance
                        description: >-
                          Total amount of points awarded to this customer and
                          available to spend.
                        example: 286
                      pendingPoints:
                        type: number
                        title: Total pending points
                        description: >-
                          Total amount of points awarded to this customer but
                          not available until their start date.
                        example: 50
                      spentPoints:
                        type: number
                        title: Total spent points
                        description: Total amount of points already spent by this customer.
                        example: 150
                      expiredPoints:
                        type: number
                        title: Total expired points
                        description: >-
                          Total amount of points awarded but never redeemed.
                          They cannot be used anymore.
                        example: 286
                      negativePoints:
                        type: number
                        title: Current negative balance
                        description: >-
                          Total amount of negative points. This implies that
                          `activePoints` is `0`.
                        example: 286
                  subledgerBalances:
                    type: object
                    description: Map of the loyalty balances of the subledgers of a ledger.
                    additionalProperties:
                      type: object
                      description: Point balance of a ledger in the Loyalty Program.
                      properties:
                        activePoints:
                          type: number
                          title: Current Balance
                          description: >-
                            Total amount of points awarded to this customer and
                            available to spend.
                          example: 286
                        pendingPoints:
                          type: number
                          title: Total pending points
                          description: >-
                            Total amount of points awarded to this customer but
                            not available until their start date.
                          example: 50
                        spentPoints:
                          type: number
                          title: Total spent points
                          description: >-
                            Total amount of points already spent by this
                            customer.
                          example: 150
                        expiredPoints:
                          type: number
                          title: Total expired points
                          description: >-
                            Total amount of points awarded but never redeemed.
                            They cannot be used anymore.
                          example: 286
                        negativePoints:
                          type: number
                          title: Current negative balance
                          description: >-
                            Total amount of negative points. This implies that
                            `activePoints` is `0`.
                          example: 286
                    example:
                      mysubledger:
                        activePoints: 286
                        pendingPoints: 50
                        spentPoints: 150
                        expiredPoints: 25
                        negativePoints: 0
              - type: object
                description: List of customer profiles linked to the loyalty card.
                properties:
                  profiles:
                    type: array
                    description: Customer profiles linked to the loyalty card.
                    items:
                      type: object
                      required:
                        - integrationId
                        - timestamp
                      properties:
                        integrationId:
                          type: string
                          maxLength: 1000
                          description: >-
                            Integration ID of the customer profile linked to the
                            card.
                          example: R195412
                        timestamp:
                          type: string
                          format: date-time
                          description: >-
                            Timestamp the customer profile was linked to the
                            card.
                          example: '2021-09-12T10:12:42Z'
    '400':
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
    '401':
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
    '404':
      description: Not found
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
