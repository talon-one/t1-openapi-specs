# path: /v1/loyalty_programs/{loyaltyProgramId}/activate_points
post:
  operationId: activateLoyaltyPoints
  summary: Activate loyalty points
  description: >
    Activate points when a defined action occurs.


    You can activate pending points using one of the following parameters:

    - `sessionId`: Activates all points earned in the specified session. 

    - `transactionUUIDs`: Activates points earned in the transactions specified
    by the 

    given UUIDs. 
  tags:
    - Loyalty
  security:
    - api_key_v1: []
  parameters:
    - name: loyaltyProgramId
      in: path
      description: >
        The identifier for the loyalty program. You can get the ID with the
        [List loyalty

        programs](https://docs.talon.one/management-api#tag/Loyalty/operation/getLoyaltyPrograms)

        endpoint.
      example: 33
      required: true
      schema:
        type: integer
  requestBody:
    content:
      application/json:
        schema:
          type: object
          description: Activate loyalty points
          additionalProperties: false
          properties:
            transactionUUIDs:
              type: array
              items:
                type: string
                format: uuid
              minItems: 1
              maxItems: 50
              uniqueItems: true
              description: >
                An array of transaction UUIDs used to activate specific pending
                point transactions. 


                If provided, do not include the `sessionId` parameter.
            sessionId:
              type: string
              minLength: 1
              description: >
                The ID of the session containing the pending point transactions
                to activate.


                If provided, do not include the `transactionUUIDs` parameter.
        examples:
          UsingTransactionUUIDs:
            summary: Activate points using transaction UUIDs
            value:
              transactionUUIDs:
                - 8f1a8d7c-9c3e-4a5e-9f0d-2c5f7a3b1cde
                - 12b3c456-78d9-4e0f-a1b2-3456789abcde
          UsingSessionId:
            summary: Activate points using sessionID
            value:
              sessionId: ac08cc3c43470426591ad75b2d685ec04_v2
    description: body
    required: true
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            type: object
            properties:
              ledgerEntries:
                type: array
                description: Updated ledger entries after activation.
                items:
                  type: object
                  description: >-
                    A single row of the ledger, describing one addition or
                    deduction.
                  required:
                    - programID
                    - type
                    - amount
                    - created
                    - name
                    - subLedgerID
                  properties:
                    created:
                      type: string
                      format: date-time
                      example: '2021-07-20T22:00:00Z'
                    programID:
                      type: integer
                      example: 5
                    customerProfileID:
                      type: string
                      example: URNGV8294NV
                    cardID:
                      type: integer
                      example: 241
                    customerSessionID:
                      type: string
                      example: t2gy5s-47274
                    eventID:
                      type: integer
                      example: 5
                    type:
                      type: string
                      description: |
                        The type of the ledger transaction. Possible values are:
                        - `addition`
                        - `subtraction`
                        - `expire`
                        - `expiring` (for expiring points ledgers)
                      example: addition
                    amount:
                      type: number
                      example: 100
                    startDate:
                      type: string
                      format: date-time
                      example: '2021-07-20T22:00:00Z'
                    expiryDate:
                      type: string
                      format: date-time
                      example: '2022-07-20T22:00:00Z'
                    name:
                      type: string
                      description: >-
                        A name referencing the condition or effect that added
                        this entry, or the specific name provided in an API
                        call.
                      example: Add points on purchase
                    subLedgerID:
                      type: string
                      description: >-
                        This specifies if we are adding loyalty points to the
                        main ledger or a subledger.
                      example: mysubledger
                    userID:
                      type: integer
                      description: >-
                        This is the ID of the user who created this entry, if
                        the addition or subtraction was done manually.
                      example: 499
                    archived:
                      type: boolean
                      description: Indicates if the entry belongs to the archived session.
                      example: false
                    flags:
                      description: >-
                        A map of flags providing additional details about the
                        entry.
                      type: object
                      properties:
                        createsNegativeBalance:
                          type: boolean
                          description: Set to true if the entry creates negative balance.
                    validityDuration:
                      type: string
                      description: >
                        The duration for which the points remain active,
                        relative to the  activation date.


                        **Note**: This only applies to points for which
                        `awaitsActivation` is `true` and `expiryDate` is not
                        set.
                      example: 30D
    '400':
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
    '401':
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
    '404':
      description: Not found
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
              errors:
                type: array
                description: >-
                  An array of individual problems encountered during the
                  request.
                items:
                  type: object
                  required:
                    - source
                    - title
                  properties:
                    title:
                      type: string
                      description: Short description of the problem.
                    details:
                      type: string
                      description: >-
                        Longer description of this specific instance of the
                        problem.
                    source:
                      type: object
                      description: >
                        The source of the current error, exactly one of
                        `pointer`, `parameter` or `line` will be defined.
                      properties:
                        pointer:
                          type: string
                          description: >-
                            Pointer to the path in the payload that caused this
                            error.
                        parameter:
                          type: string
                          description: Query parameter that caused this error.
                        line:
                          type: string
                          description: >-
                            Line number in uploaded multipart file that caused
                            this error. 'N/A' if unknown.
                        resource:
                          type: string
                          description: Pointer to the resource that caused this error.
              StatusCode:
                type: integer
                description: The error code
